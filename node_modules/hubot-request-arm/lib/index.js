var Promise, cheerio, request;

Promise = require('q').Promise;

cheerio = require('cheerio');

request = require('request');

module.exports = function(params) {
  var format;
  format = params.format;
  delete params.format;
  return new Promise(function(resolve, reject) {
    return request(params, function(err, res) {
      var e;
      if (err != null) {
        return reject(err);
      }
      switch (false) {
        case format !== 'html':
          try {
            res.$ = cheerio.load(res.body);
          } catch (_error) {
            e = _error;
            reject(e);
          }
          break;
        case format !== 'json':
          try {
            res.json = JSON.parse(res.body);
          } catch (_error) {
            e = _error;
            reject(e);
          }
      }
      return resolve(res);
    });
  });
};
